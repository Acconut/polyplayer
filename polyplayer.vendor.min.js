!function(window){!function(){var requirejs,require,define,__inflate;!function(e){function t(e,t){var n,i,r,o,s,a,u,l=t&&t.split("/"),d=p.map,c=d&&d["*"]||{};if(e&&"."===e.charAt(0)&&t){for(l=l.slice(0,l.length-1),e=l.concat(e.split("/")),s=0;u=e[s];s++)if("."===u)e.splice(s,1),s-=1;else if(".."===u){if(1===s&&(".."===e[2]||".."===e[0]))return!0;s>0&&(e.splice(s-1,2),s-=2)}e=e.join("/")}if((l||c)&&d)for(n=e.split("/"),s=n.length;s>0;s-=1){if(i=n.slice(0,s).join("/"),l)for(a=l.length;a>0;a-=1)if(r=d[l.slice(0,a).join("/")],r&&(r=r[i])){o=r;break}if(o=o||c[i]){n.splice(0,s,o),e=n.join("/");break}}return e}function n(t,n){return function(){return l.apply(e,h.call(arguments,0).concat([t,n]))}}function i(e){return function(n){return t(n,e)}}function r(e){return function(t){d[e]=t}}function o(t){if(c.hasOwnProperty(t)){var n=c[t];delete c[t],f[t]=!0,u.apply(e,n)}if(!d.hasOwnProperty(t))throw new Error("No "+t);return d[t]}function s(e,n){var r,s,a=e.indexOf("!");return-1!==a?(r=t(e.slice(0,a),n),e=e.slice(a+1),s=o(r),e=s&&s.normalize?s.normalize(e,i(n)):t(e,n)):e=t(e,n),{f:r?r+"!"+e:e,n:e,p:s}}function a(e){return function(){return p&&p.config&&p.config[e]||{}}}var u,l,d={},c={},p={},f={},h=[].slice;u=function(t,i,u,l){var p,h,v,g,y,_,m=[];if(l=l||t,"string"==typeof u&&(u=__inflate(t,u)),"function"==typeof u){for(i=!i.length&&u.length?["require","exports","module"]:i,_=0;_<i.length;_++)if(y=s(i[_],l),v=y.f,"require"===v)m[_]=n(t);else if("exports"===v)m[_]=d[t]={},p=!0;else if("module"===v)h=m[_]={id:t,uri:"",exports:d[t],config:a(t)};else if(d.hasOwnProperty(v)||c.hasOwnProperty(v))m[_]=o(v);else if(y.p)y.p.load(y.n,n(l,!0),r(v),{}),m[_]=d[v];else if(!f[v])throw new Error(t+" missing "+v);g=u.apply(d[t],m),t&&(h&&h.exports!==e&&h.exports!==d[t]?d[t]=h.exports:g===e&&p||(d[t]=g))}else t&&(d[t]=u)},requirejs=require=l=function(t,n,i,r){return"string"==typeof t?o(s(t,n).f):(t.splice||(p=t,n.splice?(t=n,n=i,i=null):t=e),n=n||function(){},r?u(e,t,n,i):setTimeout(function(){u(e,t,n,i)},15),l)},l.config=function(e){return p=e,l},define=function(e,t,n){t.splice||(n=t,t=[]),c[e]=[e,t,n]},define.amd={jQuery:!0}}(),__inflate=function(name,src){var r;return eval(["r = function(a,b,c){","\n};\n//@ sourceURL="+name+"\n"].join(src)),r},define("lib/api/events",["require","exports","module"],function(e,t){t.api={LOAD_PROGRESS:"loadProgress",PLAY_PROGRESS:"playProgress",PLAY:"play",PAUSE:"pause",FINISH:"finish",SEEK:"seek",READY:"ready",OPEN_SHARE_PANEL:"sharePanelOpened",CLICK_DOWNLOAD:"downloadClicked",CLICK_BUY:"buyClicked",ERROR:"error"},t.bridge={REMOVE_LISTENER:"removeEventListener",ADD_LISTENER:"addEventListener"}}),define("lib/api/getters",["require","exports","module"],function(e,t,n){n.exports={GET_VOLUME:"getVolume",GET_DURATION:"getDuration",GET_POSITION:"getPosition",GET_SOUNDS:"getSounds",GET_CURRENT_SOUND:"getCurrentSound",GET_CURRENT_SOUND_INDEX:"getCurrentSoundIndex",IS_PAUSED:"isPaused"}}),define("lib/api/setters",["require","exports","module"],function(e,t,n){n.exports={PLAY:"play",PAUSE:"pause",TOGGLE:"toggle",SEEK_TO:"seekTo",SET_VOLUME:"setVolume",NEXT:"next",PREV:"prev",SKIP:"skip"}}),define("lib/api/api",["require","exports","module","lib/api/events","lib/api/getters","lib/api/setters"],function(e,t,n){function i(e){return!!(""===e||e&&e.charCodeAt&&e.substr)}function r(e){return!!(e&&e.constructor&&e.call&&e.apply)}function o(e){return!!e&&1===e.nodeType&&"IFRAME"===e.nodeName.toUpperCase()}function s(e){var t,n=!1;for(t in R)if(R.hasOwnProperty(t)&&R[t]===e){n=!0;break}return n}function a(e){var t,n,i;for(t=0,n=O.length;n>t&&(i=e(O[t]),i!==!1);t++);}function u(e){var t,n,i,r="";for("//"===e.substr(0,2)&&(e=window.location.protocol+e),i=e.split("/"),t=0,n=i.length;n>t&&3>t;t++)r+=i[t],2>t&&(r+="/");return r}function l(e){return e.contentWindow?e.contentWindow:e.contentDocument&&"parentWindow"in e.contentDocument?e.contentDocument.parentWindow:null}function d(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(e[t]);return n}function c(e,t,n){n.callbacks[e]=n.callbacks[e]||[],n.callbacks[e].push(t)}function p(e,t){var n,i=!0;return t.callbacks[e]=[],a(function(t){return n=t.callbacks[e]||[],n.length?(i=!1,!1):void 0}),i}function f(e,t,n){var i,r,o=l(n);return o.postMessage?(i=n.getAttribute("src").split("?")[0],r=JSON.stringify({method:e,value:t}),"//"===i.substr(0,2)&&(i=window.location.protocol+i),i=i.replace(/http:\/\/(w|wt).soundcloud.com/,"https://$1.soundcloud.com"),o.postMessage(r,i),void 0):!1}function h(e){var t;return a(function(n){return n.instance===e?(t=n,!1):void 0}),t}function v(e){var t;return a(function(n){return l(n.element)===e?(t=n,!1):void 0}),t}function g(e,t){return function(n){var i=r(n),o=h(this),s=!i&&t?n:null,a=i&&!t?n:null;return a&&c(e,a,o),f(e,s,o.element),this}}function y(e,t,n){var i,r,o;for(i=0,r=t.length;r>i;i++)o=t[i],e[o]=g(o,n)}function _(e,t,n){return e+"?url="+t+"&"+m(n)}function m(e){var t,n,i=[];for(t in e)e.hasOwnProperty(t)&&(n=e[t],i.push(t+"="+("start_track"===t?parseInt(n,10):n?"true":"false")));return i.join("&")}function w(e,t,n){var i,r,o=e.callbacks[t]||[];for(i=0,r=o.length;r>i;i++)o[i].apply(e.instance,n);(s(t)||t===D.READY)&&(e.callbacks[t]=[])}function P(e){var t,n,i,r,o;try{n=JSON.parse(e.data)}catch(s){return!1}return t=v(e.source),i=n.method,r=n.value,t&&E(e.origin)===E(t.domain)?(i===D.READY&&(t?(t.isReady=!0,w(t,L),p(L,t)):C.push(e.source)),i===D.PLAY&&!t.playEventFired&&(t.playEventFired=!0),i===D.PLAY_PROGRESS&&!t.playEventFired&&(t.playEventFired=!0,w(t,D.PLAY,[r])),o=[],void 0!==r&&o.push(r),w(t,i,o),void 0):!1}function E(e){return e.replace(U,"")}var I,b,S,A=e("lib/api/events"),R=e("lib/api/getters"),T=e("lib/api/setters"),D=A.api,k=A.bridge,C=[],O=[],L="__LATE_BINDING__",N="http://wt.soundcloud.dev:9200/",U=/^http(?:s?)/;window.addEventListener?window.addEventListener("message",P,!1):window.attachEvent("onmessage",P),n.exports=S=function(e,t,n){if(i(e)&&(e=document.getElementById(e)),!o(e))throw new Error("SC.Widget function should be given either iframe element or a string specifying id attribute of iframe element.");t&&(n=n||{},e.src=_(N,t,n));var r,s,a=v(l(e));return a&&a.instance?a.instance:(r=C.indexOf(l(e))>-1,s=new I(e),O.push(new b(s,e,r)),s)},S.Events=D,window.SC=window.SC||{},window.SC.Widget=S,b=function(e,t,n){this.instance=e,this.element=t,this.domain=u(t.getAttribute("src")),this.isReady=!!n,this.callbacks={}},I=function(){},I.prototype={constructor:I,load:function(e,t){if(e){t=t||{};var n=this,i=h(this),r=i.element,o=r.src,s=o.substr(0,o.indexOf("?"));i.isReady=!1,i.playEventFired=!1,r.onload=function(){n.bind(D.READY,function(){var e,n=i.callbacks;for(e in n)n.hasOwnProperty(e)&&e!==D.READY&&f(k.ADD_LISTENER,e,i.element);t.callback&&t.callback()})},r.src=_(s,e,t)}},bind:function(e,t){var n=this,i=h(this);return i&&i.element&&(e===D.READY&&i.isReady?setTimeout(t,1):i.isReady?(c(e,t,i),f(k.ADD_LISTENER,e,i.element)):c(L,function(){n.bind(e,t)},i)),this},unbind:function(e){var t,n=h(this);n&&n.element&&(t=p(e,n),e!==D.READY&&t&&f(k.REMOVE_LISTENER,e,n.element))}},y(I.prototype,d(R)),y(I.prototype,d(T),!0)}),window.SC=window.SC||{},window.SC.Widget=require("lib/api/api")}();var Froogaloop=function(){function e(t){return new e.fn.init(t)}function t(e,t,n){if(!n.contentWindow.postMessage)return!1;var i=n.getAttribute("src").split("?")[0],r=JSON.stringify({method:e,value:t});"//"===i.substr(0,2)&&(i=window.location.protocol+i),n.contentWindow.postMessage(r,i)}function n(e){var t,n;try{t=JSON.parse(e.data),n=t.event||t.method}catch(i){}if("ready"!=n||l||(l=!0),e.origin!=d)return!1;var o=t.value,s=t.data,a=""===a?null:t.player_id,u=r(n,a),c=[];return u?(void 0!==o&&c.push(o),s&&c.push(s),a&&c.push(a),c.length>0?u.apply(null,c):u.call()):!1}function i(e,t,n){n?(u[n]||(u[n]={}),u[n][e]=t):u[e]=t}function r(e,t){return t?u[t][e]:u[e]}function o(e,t){if(t&&u[t]){if(!u[t][e])return!1;u[t][e]=null}else{if(!u[e])return!1;u[e]=null}return!0}function s(e){"//"===e.substr(0,2)&&(e=window.location.protocol+e);for(var t=e.split("/"),n="",i=0,r=t.length;r>i&&3>i;i++)n+=t[i],2>i&&(n+="/");return n}function a(e){return!!(e&&e.constructor&&e.call&&e.apply)}var u={},l=!1,d=(Array.prototype.slice,"");return e.fn=e.prototype={element:null,init:function(e){return"string"==typeof e&&(e=document.getElementById(e)),this.element=e,d=s(this.element.getAttribute("src")),this},api:function(e,n){if(!this.element||!e)return!1;var r=this,o=r.element,s=""!==o.id?o.id:null,u=a(n)?null:n,l=a(n)?n:null;return l&&i(e,l,s),t(e,u,o),r},addEvent:function(e,n){if(!this.element)return!1;var r=this,o=r.element,s=""!==o.id?o.id:null;return i(e,n,s),"ready"!=e?t("addEventListener",e,o):"ready"==e&&l&&n.call(null,s),r},removeEvent:function(e){if(!this.element)return!1;var n=this,i=n.element,r=""!==i.id?i.id:null,s=o(e,r);"ready"!=e&&s&&t("removeEventListener",e,i)}},e.fn.init.prototype=e.fn,window.addEventListener?window.addEventListener("message",n,!1):window.attachEvent("onmessage",n),window.Froogaloop=window.$f=e}(),Player=function e(t){var n={provider:null,videoId:null,videoUrl:null,prefetchInfo:!1,container:document.body};if(_.extend(n,t),n.videoUrl){var i=this._parseUrl(n.videoUrl);_.extend(n,i)}return n.container instanceof Element||(n.container=document.querySelector(n.container)),n.playerId=e._generatePlayerId(),new this._providers[n.provider](n)};Player.prototype._providers={youtube:null,vimeo:null,soundcloud:null},Player.prototype._parseUrl=function(e){var t={provider:null,videoUrl:null,videoId:null};try{var n=/^(https?:\/\/)?(www.)?([a-z0-9\-]+)\.[a-z]+(\/(.*))?/i.exec(e);if(null===n)throw"Invalid url";var i=n[3].toLowerCase(),r=n[5]||"";if(!(i in this._providers))throw"Unknown provider";if(t.provider=i,t.videoUrl=e,"youtube"===i){var o=/v=([A-Za-z0-9\-_]+)/.exec(e);if(null===o)throw"YouTube requires a URL containing the video ID (v)";t.videoId=o[1]}else if("vimeo"===i){if(!/^[0-9]+$/.test(r))throw"Vimeo must be a numeric video url";t.videoId=parseInt(r,10)}else if("soundcloud"===i){if(/^[0-9a-zA-Z-_]+\/sets\/[0-9a-zA-Z-_]+$/i.test(r))throw"Soundcloud sets are not implemented yet";if(!/^[0-9a-zA-Z-_]+\/[0-9a-zA-Z-_]+$/i.test(r))throw"This is not a valid url to a song on Soundcloud"}}catch(s){throw s}return t},Player._lastPlayerId=0,Player._generatePlayerId=function(){return"polyplayer_"+this._lastPlayerId++},Player.states={LOADING:0,READY:1,PLAYING:2,PAUSED:3,FINISHED:4,STOPPED:5};var Model=Backbone.Model.extend({defaults:{rawDetails:null,details:null,videoId:null,videoUrl:null,playerId:null,state:Player.states.LOADING,currentPosition:null,duration:null},_setState:function(e){var t=Player.states[e.toUpperCase()];this.set("state",t),this.trigger("stateChange",t)},_setCurrentPosition:function(e){this.set("currentPosition",e),this.trigger("playProgress",{currentPosition:e,relativePosition:e/this.get("duration")})},seek:function(e){var t=this;this.getDetails(function(n){t.seekTo(e*n.duration)})},getDetails:function(e){if(this.get("state")===Player.states.LOADING)return this.on("ready",_.bind(this.getDetails,this,e)),void 0;var t=this.get("details");if(null!==t)return e(t);var n=this;this._fetchDetails(function(t){n.set("details",t),e(t)})},getCurrentPosition:function(){return this.get("currentPosition")},getDuration:function(){return this.get("duration")},getState:function(){return this.get("state")}});Player.prototype._providers.soundcloud=Model.extend({initialize:function(e){this.set({playerId:e.playerId,url:e.videoUrl,videoId:e.videoId});var t=document.createElement("iframe");t.setAttribute("id",e.playerId),t.setAttribute("src","https://w.soundcloud.com/player/?url="+encodeURIComponent(e.videoUrl)),e.container.appendChild(t);var n=this.widget=SC.Widget(t);n.bind(SC.Widget.Events.READY,_.bind(this._onReady,this)),n.bind(SC.Widget.Events.PAUSE,_.bind(this._onPause,this)),n.bind(SC.Widget.Events.PLAY,_.bind(this._onPlay,this)),n.bind(SC.Widget.Events.FINISH,_.bind(this._onFinish,this)),n.bind(SC.Widget.Events.PLAY_PROGRESS,_.bind(this._onPlayProgress,this))},play:function(){this.widget.play()},pause:function(){this.widget.pause()},seekTo:function(e){this.widget.seekTo(e),this._setCurrentPosition(e)},stop:function(){this.pause(),this.seek(0),this._setCurrentPosition(0);var e=this;setTimeout(function(){e._setState("stopped"),e.trigger("stop")},100)},_fetchDetails:function(e){this.widget.getCurrentSound(_.bind(function(t){this.set("rawDetails",t);var n={duration:t.duration,id:t.id,title:t.title,createdAt:new Date(t.created_at),thumbnails:[{width:100,height:100,url:t.artwork_url}]};this.set("details",n),e(n)},this))},_onReady:function(){var e=this;this.widget.getDuration(function(t){e.set("duration",t),e._setState("ready"),e.trigger("ready")})},_onPause:function(){this._setState("paused"),this.trigger("pause")},_onPlay:function(){this._setState("playing"),this.trigger("play")},_onFinish:function(){this.stop(),this._setState("finished"),this.trigger("finish")},_onPlayProgress:function(e){this.set("currentPosition",e.currentPosition),this.trigger("playProgress",e)}}),Player.prototype._providers.youtube=Model.extend({initialize:function(e){this.set({playerId:e.playerId,url:e.videoUrl,videoId:e.videoId});var t=document.createElement("div");t.setAttribute("id",e.playerId),e.container.appendChild(t);var n=this,i=function(){n.player=new YT.Player(e.playerId,{videoId:e.videoId,events:{onStateChange:function(e){n._setStateById(e.data)},onReady:function(){n._onReady()}}})};if("YT"in window)i();else{var r=document.createElement("script");r.src="https://www.youtube.com/iframe_api";var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(r,o),onYouTubeIframeAPIReady._callbacks.push(i)}this.on("play",this._setInterval),this.on("pause",this._clearInterval),this.on("finish",this._clearInterval)},_onReady:function(){this.set("duration",1e3*this.player.getDuration()),this._setState("ready"),this.trigger("ready")},play:function(){this.get("state")===Player.states.STOPPED&&this.seekTo(0),this.player.playVideo()},pause:function(){this.player.pauseVideo()},stop:function(){this.player.stopVideo(),this.pause(),this._setCurrentPosition(0),this._setState("stopped"),this.trigger("stop")},seekTo:function(e){if(this._seekValue=e,this._setCurrentPosition(e),!this._seekTimeoutSet){this._seekTimeoutSet=!0;var t=this;setTimeout(function(){var e=t._seekValue;t.player.seekTo(e/1e3,!0),t._seekTimeoutSet=!1},500)}},_seekValue:null,_seekTimeoutSet:!1,_setInterval:function(){var e=this;this._intervalId=setInterval(function(){var t=e.player.getCurrentTime();e._setCurrentPosition(1e3*t)},1e3)},_clearInterval:function(){clearInterval(this._intervalId),this._intervalId=null},_fetchDetails:function(e){var t=this,n=new XMLHttpRequest;n.onload=function(n){var i=n.target.responseText;try{i=JSON.parse(i).entry}catch(r){throw r}t.set("rawDetails",i);var o={title:i.title.$t,duration:1e3*parseInt(i.media$group.yt$duration.seconds),thumbnails:[],createdAt:new Date(i.published.$t)};_.each(i.media$group.media$thumbnail,function(e){o.thumbnails.push({height:e.height,width:e.width,url:e.url})}),t.set("details",o),e(o)},n.open("get","https://gdata.youtube.com/feeds/api/videos/"+this.get("videoId")+"?v=2&alt=json",!0),n.send()},_setStateById:function(e){var t={"-1":"loading",0:"finished",1:"playing",2:"paused",3:null,5:"ready"},n=t[e];null!==n&&(this._setState(n),"playing"===n?this.trigger("play"):"paused"==n?this.trigger("pause"):"finished"==n&&this.trigger("finish"))}}),window.onYouTubeIframeAPIReady&&console&&console.log&&console.log("[Polyplayer] There is already a function `onYouTubeIframeAPIReady` declared. It will be overwritten"),window.onYouTubeIframeAPIReady=function(){for(var e=0;e<onYouTubeIframeAPIReady._callbacks.length;e++)onYouTubeIframeAPIReady._callbacks[e]()},window.onYouTubeIframeAPIReady._callbacks=[],Player.prototype._providers.vimeo=Model.extend({initialize:function(e){this.set({playerId:e.playerId,url:e.videoUrl,videoId:e.videoId});var t=document.createElement("iframe");t.setAttribute("id",e.playerId),t.setAttribute("src","http://player.vimeo.com/video/"+e.videoId+"?api=1&player_id="+e.playerId),e.container.appendChild(t);var n=this.player=$f(t),i=this;n.addEvent("ready",function(){n.api("getDuration",function(e){i.set("duration",parseInt(1e3*e)),i._setState("ready"),i.trigger("ready")}),n.addEvent("playProgress",function(e){i.trigger("progress",{relativePosition:e.percent})}),n.addEvent("play",function(){i.trigger("play"),i._setState("playing")}),n.addEvent("pause",function(){i.trigger("pause"),i._setState("paused")}),n.addEvent("finish",function(){i.stop(),i._setState("finished"),i.trigger("finish")}),n.addEvent("playProgress",function(e){i.set("currentPosition",1e3*e.seconds),i.trigger("playProgress",{currentPosition:1e3*e.seconds,relativePosition:e.percent})})})},play:function(){this.player.api("play")},pause:function(){this.player.api("pause")},seekTo:function(e){this.player.api("seekTo",e/1e3),this._setCurrentPosition(e)},stop:function(){this.pause(),this.seek(0),this._setCurrentPosition(0),this._setState("stopped"),this.trigger("stop")},_fetchDetails:function(e){var t=this,n=new XMLHttpRequest;n.onload=function(n){var i=n.target.responseText;try{i=JSON.parse(i)[0]}catch(r){throw r}t.set("rawDetails",i);var o=/(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})/.exec(i.upload_date),s=new Date(o[1],o[2]-1,o[3],o[4],o[5],o[6]),a={title:i.title,duration:1e3*parseInt(i.duration),thumbnails:[{width:100,height:100,url:i.thumbnail_small},{width:200,height:200,url:i.thumbnail_medium},{width:640,height:640,url:i.thumbnail_large}],createdAt:s};t.set("details",a),e(a)},n.open("get","http://vimeo.com/api/v2/video/"+this.get("videoId")+".json",!0),n.send()}});var PP={};PP.Player=Player,window.PP=PP}(window);